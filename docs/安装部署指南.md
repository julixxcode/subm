# 订阅管理系统 - 安装部署指南

## 📋 概述

订阅管理系统是一个现代化的订阅服务管理平台，帮助用户轻松管理和跟踪各种订阅服务的费用和续费情况。

### 🌟 主要功能
- **智能订阅管理** - 完整的订阅生命周期管理，支持自动/手动续费
- **多币种支持** - 支持8种主要货币，实时汇率自动更新
- **费用分析报告** - 强大的数据分析和可视化图表功能
- **响应式设计** - 完美适配桌面和移动端
- **本地优先** - 基于SQLite的本地数据存储，保护用户隐私
- **🔐 许可证系统** - 支持免费版、专业版、荣誉终生版

## 🚀 快速开始

### 系统要求
- **Node.js**: 20+ 版本
- **内存**: 至少 512MB
- **存储**: 至少 100MB 可用空间
- **网络**: 需要互联网连接（用于汇率更新和许可证验证）

### 安装方式

#### 方式一：Docker run 部署（推荐）

数据目录准备

```bash
# 创建数据目录并设置权限
mkdir -p ${PWD}/subscription-manager/data
chown -R 1001:1001 ${PWD}/subscription-manager/data
chmod 755 ${PWD}/subscription-manager/data
```

```bash
docker stop subscription-manager
docker rm subscription-manager

docker run -d \
  --name subscription-manager \
  --restart unless-stopped \
  --user 0 \
  -p 3001:3001 \
  -v ${PWD}/subscription-manager/data:/app/data \
  -e API_KEY="your_secret_api_key_here" \
  -e TIANAPI_KEY="your_tianapi_key_here" \
  -e PORT="3001" \
  -e BASE_CURRENCY="CNY" \
  -e NODE_ENV="production" \
  -e VITE_API_URL="/api" \
  -e DATABASE_PATH="/app/data/database.sqlite" \
  zhoujie218/subscription-manager:latest
```



**访问应用**
打开浏览器访问：`http://localhost:5173`



## ⚙️ 配置说明

### 环境变量配置

#### 基础配置
```bash
# .env
# API密钥（必需）
API_KEY=your-api-key-here

# 端口配置
PORT=3001

# 基础货币
BASE_CURRENCY=CNY

# 汇率API密钥（可选，用于自动汇率更新）
TIANAPI_KEY=your-tianapi-key

# 数据库路径
DATABASE_PATH=./db/database.sqlite
```



### 许可证系统配置

#### 版本类型
- **免费版** - 限制7个订阅，基础功能
- **专业版** - 无限制订阅，1年有效期
- **荣誉终生版** - 无限制订阅，永久有效

#### 激活许可证
1. 访问设置页面
2. 点击"许可证管理"
3. 输入许可证密钥
4. 点击"验证许可证"



## 🔧 部署配置

#### Nginx 配置示例
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:3001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### SSL 证书配置
```bash
# 使用 Let's Encrypt
sudo certbot --nginx -d your-domain.com
```



## 📱 使用指南

### 基本操作

#### 添加订阅
1. 点击"添加订阅"按钮
2. 填写订阅信息（名称、金额、计费周期等）
3. 选择分类和支付方式
4. 点击"保存"

#### 管理订阅
- **编辑**：点击订阅卡片上的编辑按钮
- **删除**：点击订阅卡片上的删除按钮
- **状态管理**：可以设置订阅为活跃、试用或已取消

#### 查看报告
- **仪表板**：查看总体费用概览
- **费用报告**：查看详细的费用分析图表
- **支付历史**：查看所有支付记录

### 数据管理

#### 导入数据
1. 点击"导入"按钮
2. 选择 CSV 或 JSON 文件
3. 确认导入数据
4. 查看导入结果

#### 导出数据
1. 点击"导出"按钮
2. 选择导出格式（CSV 或 JSON）
3. 下载导出文件

#### 备份数据
```bash
# 备份数据库文件
cp ./server/db/database.sqlite ./backup/database-$(date +%Y%m%d).sqlite
```

## 🔍 故障排除

### 常见问题

#### 1. 服务无法启动
```bash
# 检查端口是否被占用
lsof -i :3001

# 检查日志
docker logs subscription-manager
```

#### 2. 数据库错误
```bash
# 重新初始化数据库
cd server
npm run db:reset
```

#### 3. 许可证验证失败
- 检查网络连接
- 确认许可证密钥正确
- 查看许可证服务器状态

#### 4. 汇率更新失败
- 检查 TIANAPI_KEY 是否正确
- 确认网络连接正常
- 查看服务器日志

### 日志查看

#### Docker 日志
```bash
# 查看容器日志
docker logs subscription-manager

# 实时查看日志
docker logs -f subscription-manager
```

#### 
## 📞 技术支持

如有问题，请通过以下方式获取支持：
- 查看本文档的故障排除部分
- 提交 [GitHub Issue](https://github.com/vbskycn/subm/issues)
- 联系开发者获取技术支持 